(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16b0ab40"],{"3e9f":function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=(i("eb3b"),i("b1f6"),function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i,this.lastStageList=[]}return Object(r["a"])(e,[{key:"add",value:function(e,t,i,a){this.lastStageList.push(this.showRadarScan(e,t,i,a))}},{key:"clear",value:function(){var e=this;this.lastStageList.forEach((function(t){e.clearScanEffects(t)})),this.lastStageList=[]}},{key:"showRadarScan",value:function(e,t,i,a){var r=this.Cesium,n=new r.Cartographic(r.Math.toRadians(e[0]),r.Math.toRadians(e[1]),e[2]);t=new r.Color.fromCssColorString(t);var o=this._addRadarScanPostStage(n,i,t,a);return o}},{key:"_addRadarScanPostStage",value:function(e,t,i,a){var r=this.Cesium,n=r.Cartographic.toCartesian(e),o=new r.Cartesian4(n.x,n.y,n.z,1),s=new r.Cartographic(e.longitude,e.latitude,e.height+500),l=r.Cartographic.toCartesian(s),c=new r.Cartesian4(l.x,l.y,l.z,1),u=new r.Cartographic(e.longitude+r.Math.toRadians(.001),e.latitude,e.height),d=r.Cartographic.toCartesian(u),p=new r.Cartesian4(d.x,d.y,d.z,1),h=new r.Quaternion,m=new r.Matrix3,f=(new Date).getTime(),v=new r.Cartesian4,g=new r.Cartesian4,y=new r.Cartesian4,C=new r.Cartesian3,_=new r.Cartesian3,w=this,b=new r.PostProcessStage({fragmentShader:this._getRadarScanShader(),uniforms:{u_scanCenterEC:function(){return r.Matrix4.multiplyByVector(w.viewer.camera._viewMatrix,o,v)},u_scanPlaneNormalEC:function(){var e=r.Matrix4.multiplyByVector(w.viewer.camera._viewMatrix,o,v),t=r.Matrix4.multiplyByVector(w.viewer.camera._viewMatrix,c,g);return C.x=t.x-e.x,C.y=t.y-e.y,C.z=t.z-e.z,r.Cartesian3.normalize(C,C),C},u_radius:t,u_scanLineNormalEC:function(){var e=r.Matrix4.multiplyByVector(w.viewer.camera._viewMatrix,o,v),t=r.Matrix4.multiplyByVector(w.viewer.camera._viewMatrix,c,g),i=r.Matrix4.multiplyByVector(w.viewer.camera._viewMatrix,p,y);C.x=t.x-e.x,C.y=t.y-e.y,C.z=t.z-e.z,r.Cartesian3.normalize(C,C),_.x=i.x-e.x,_.y=i.y-e.y,_.z=i.z-e.z;var n=((new Date).getTime()-f)%a/a;return r.Quaternion.fromAxisAngle(C,n*r.Math.PI*2,h),r.Matrix3.fromQuaternion(h,m),r.Matrix3.multiplyByVector(m,_,_),r.Cartesian3.normalize(_,_),_},u_scanColor:i}});return this.viewer.scene.postProcessStages.add(b),b}},{key:"_getRadarScanShader",value:function(){var e="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform vec3 u_scanLineNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\nvec4 toEye(in vec2 uv, in float depth)\n {\n vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n posInCamera =posInCamera / posInCamera.w;\n return posInCamera;\n }\nbool isPointOnLineRight(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt)\n{\nvec3 v01 = testPt - ptOnLine;\nnormalize(v01);\nvec3 temp = cross(v01, lineNormal);\nfloat d = dot(temp, u_scanPlaneNormalEC);\nreturn d > 0.5;\n}\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point)\n{\nvec3 v01 = point -planeOrigin;\nfloat d = dot(planeNormal, v01) ;\nreturn (point - planeNormal * d);\n}\nfloat distancePointToLine(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt)\n{\nvec3 tempPt = pointProjectOnPlane(lineNormal, ptOnLine, testPt);\nreturn length(tempPt - ptOnLine);\n}\nfloat getDepth(in vec4 depth)\n{\nfloat z_window = czm_unpackDepth(depth);\nz_window = czm_reverseLogDepth(z_window);\nfloat n_range = czm_depthRange.near;\nfloat f_range = czm_depthRange.far;\nreturn (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvoid main()\n{\ngl_FragColor = texture2D(colorTexture, v_textureCoordinates);\nfloat depth = getDepth( texture2D(depthTexture, v_textureCoordinates));\nvec4 viewPos = toEye(v_textureCoordinates, depth);\nvec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\nfloat dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\nfloat twou_radius = u_radius * 2.0;\nif(dis < u_radius)\n{\nfloat f0 = 1.0 -abs(u_radius - dis) / u_radius;\nf0 = pow(f0, 64.0);\nvec3 lineEndPt = vec3(u_scanCenterEC.xyz) + u_scanLineNormalEC * u_radius;\nfloat f = 0.0;\nif(isPointOnLineRight(u_scanCenterEC.xyz, u_scanLineNormalEC.xyz, prjOnPlane.xyz))\n{\nfloat dis1= length(prjOnPlane.xyz - lineEndPt);\nf = abs(twou_radius -dis1) / twou_radius;\nf = pow(f, 3.0);\n}\ngl_FragColor = mix(gl_FragColor, u_scanColor, f + f0);\n}\n}\n";return e}},{key:"clearScanEffects",value:function(e){this.viewer.scene.postProcessStages.remove(e)}}]),e}());t["a"]=n},"49ad":function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=i("4eba"),o=(i("2237"),function(){function e(t,i,r){Object(a["a"])(this,e),Object(n["a"])(this,"viewer",void 0),Object(n["a"])(this,"id",void 0),Object(n["a"])(this,"duration",void 0),Object(n["a"])(this,"maxRadius",void 0),Object(n["a"])(this,"pointDraged",void 0),Object(n["a"])(this,"leftDownFlag",void 0),Object(n["a"])(this,"update_position",void 0),this.Cesium=t,this.viewer=i,this.id=r,this.duration=1e3,this.maxRadius=1e3,this.pointDraged=null,this.leftDownFlag=!1}return Object(r["a"])(e,[{key:"change_duration",value:function(e){this.duration=e}},{key:"change_color",value:function(e){var t=this.Cesium,i=this.viewer.entities.getById(this.id);i._ellipse._material.color=new t.Color.fromCssColorString(e)}},{key:"change_position",value:function(e){var t=this.Cesium,i=t.Cartesian3.fromDegrees(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])),a=this.viewer.entities.getById(this.id);a.position=i}},{key:"del",value:function(){this.viewer.entities.removeById(this.id)}},{key:"add",value:function(e,t,i,a){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=this.Cesium,o=this;function s(e){o.pointDraged=o.viewer.scene.pick(e.position),o.pointDraged&&o.pointDraged.id&&o.pointDraged.id.id===o.id&&(o.leftDownFlag=!0,o.viewer.scene.screenSpaceCameraController.enableRotate=!1)}function l(e){o.leftDownFlag=!1,o.pointDraged=null,o.viewer.scene.screenSpaceCameraController.enableRotate=!0}function c(e){if(!0===o.leftDownFlag&&null!==o.pointDraged&&void 0!==o.pointDraged){var t=o.viewer.camera.getPickRay(e.endPosition),i=o.viewer.scene.globe.pick(t,o.viewer.scene);o.pointDraged.id.position=i;var a=o.viewer.scene.globe.ellipsoid,r=a.cartesianToCartographic(i),s=n.Math.toDegrees(r.latitude),l=n.Math.toDegrees(r.longitude),c=r.height;c=c<0?0:c,o.update_position&&o.update_position([l.toFixed(8),s.toFixed(8),c])}}this.duration=a,this.maxRadius=i,r&&(this.viewer.screenSpaceEventHandler.setInputAction(s,n.ScreenSpaceEventType.LEFT_DOWN),this.viewer.screenSpaceEventHandler.setInputAction(l,n.ScreenSpaceEventType.LEFT_UP),this.viewer.screenSpaceEventHandler.setInputAction(c,n.ScreenSpaceEventType.MOUSE_MOVE))}}]),e}());t["a"]=o},"78be":function(e,t,i){var a=i("46a7"),r=i("bc35"),n=i("5386");a({target:"Array",proto:!0},{fill:r}),n("fill")},"870b":function(e,t,i){var a=i("46a7"),r=i("4cf9"),n=i("5621"),o=i("9923"),s=i("a731"),l=i("6311"),c=i("6b85");function u(e,t){var i,a,d=arguments.length<3?e:arguments[2];return o(e)===d?e[t]:(i=l.f(e,t),i?s(i)?i.value:void 0===i.get?void 0:r(i.get,d):n(a=c(e))?u(a,t,d):void 0)}a({target:"Reflect",stat:!0},{get:u})},8909:function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=i("c686"),o=i("b5db"),s=i("e4ae"),l=i("721f"),c=i("49ad"),u=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(e){var t=this.Cesium,i=(this.viewer,null!==e&&void 0!==e&&e.cesiumName?e.cesiumName:"");function a(){this._definitionChanged=new t.Event,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this._time=(new Date).getTime()}Object.defineProperties(a.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:t.createPropertyDescriptor("color")});var r="HexagonSpreadMaterial".concat(parseInt(1e3*Math.random()));return a.prototype.getType=function(e){return r},a.prototype.getValue=function(e,i){return t.defined(i)||(i={}),i.color=t.Property.getValueOrClonedDefault(this._color,e,t.Color.WHITE,i.color),i.image=t.Material.HexagonSpreadMaterialImage,i},a.prototype.equals=function(e){return this===e||e instanceof a&&t.Property.equals(this._color,e._color)},t.Material.HexagonSpreadMaterialImage="/cesium-template/cesium/effects/Materials/hexagon.png",t.Material.HexagonSpreadSource="\n        czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n             czm_material material = czm_getDefaultMaterial(materialInput);\n             vec2 st = materialInput.st;\n             vec4 colorImage = texture2D(image,  vec2(st));\n             material.alpha = colorImage.a * color.a * 0.5;\n             material.diffuse =  1.8 * color.rgb  ;\n             return material;\n         }\n         ",t.Material._materialCache.addMaterial(r,{fabric:{type:t.Material.HexagonSpreadMaterialType,uniforms:{color:new t.Color(1,0,0,.5),image:t.Material.HexagonSpreadMaterialImage},source:t.Material.HexagonSpreadSource},translucent:function(e){return!0}}),t[i]=a,a}}]),e}(),d=u,p=function(e){Object(s["a"])(i,e);var t=Object(l["a"])(i);function i(e,r,n){var o;return Object(a["a"])(this,i),o=t.call(this,e,r,n),o._HexagonSpreadMaterialProperty=new d(e,r),o}return Object(r["a"])(i,[{key:"add",value:function(e,t,a,r){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=this.Cesium;Object(n["a"])(Object(o["a"])(i.prototype),"add",this).call(this,e,t,a,r,s);var c=this,u=1;this._HexagonSpreadMaterialProperty.create({cesiumName:"HexagonSpreadMaterialProperty",color:new l.Color.fromCssColorString(t)}),this.viewer.entities.add({id:c.id,position:l.Cartesian3.fromDegrees(e[0],e[1],e[2]),ellipse:{semiMajorAxis:new l.CallbackProperty((function(e){return u+=1e3/c.duration*50,u>c.maxRadius&&(u=1),u}),!1),semiMinorAxis:new l.CallbackProperty((function(e){return u}),!1),material:new l.HexagonSpreadMaterialProperty}})}}]),i}(c["a"]);t["a"]=p},"97df":function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=i("a035"),o=i("c686"),s=i("b5db"),l=i("e4ae"),c=i("721f"),u=i("4eba"),d=i("49ad"),p=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(e){var t=this.Cesium,i=(this.viewer,null!==e&&void 0!==e&&e.cesiumName?e.cesiumName:"");function a(){this._definitionChanged=new t.Event,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=t.defaultValue(e.duration,1e3),this.count=t.defaultValue(e.count,2),this.count<=0&&(this.count=1),this.gradient=t.defaultValue(e.gradient,.1),0===this.gradient&&(this.gradient=0),this.gradient>1&&(this.gradient=1),this._time=(new Date).getTime()}Object.defineProperties(a.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:t.createPropertyDescriptor("color"),duration:t.createPropertyDescriptor("duration"),count:t.createPropertyDescriptor("count")});var r="CircleWaveMaterial".concat(parseInt(1e3*Math.random()));return a.prototype.getType=function(e){return r},a.prototype.getValue=function(e,i){return t.defined(i)||(i={}),i.color=t.Property.getValueOrClonedDefault(this._color,e,t.Color.WHITE,i.color),i.time=((new Date).getTime()-this._time)%this.duration/this.duration,i.count=this.count,i.gradient=1+10*(1-this.gradient),i},a.prototype.equals=function(e){return this===e||e instanceof a&&t.Property.equals(this._color,e._color)},t.Material.CircleWaveSource="\n                                  czm_material czm_getMaterial(czm_materialInput materialInput) {\n                                    czm_material material = czm_getDefaultMaterial(materialInput);\n                                    material.diffuse = 1.5 * color.rgb;\n                                    vec2 st = materialInput.st;\n                                    vec3 str = materialInput.str;\n                                    float dis = distance(st, vec2(0.5, 0.5));\n                                    float per = fract(time);\n                                    if (abs(str.z) > 0.001) {\n                                      discard;\n                                    }\n                                    if (dis > 0.5) {\n                                      discard;\n                                    } else {\n                                      float perDis = 0.5 / count;\n                                      float disNum;\n                                      float bl = .0;\n                                      for (int i = 0; i <= 9; i++) {\n                                        if (float(i) <= count) {\n                                          disNum = perDis *float(i) - dis + per / count;\n                                          if (disNum > 0.0) {\n                                            if (disNum < perDis) {\n                                              bl = 1.0 - disNum / perDis;\n                                            } else if(disNum - perDis < perDis) {\n                                              bl = 1.0 - abs(1.0 - disNum / perDis);\n                                            }\n                                            material.alpha = pow(bl, gradient);\n                                          }\n                                        }\n                                      }\n                                    }\n                                    return material;\n                                  }\n                                  ",t.Material._materialCache.addMaterial(r,{fabric:{type:r,uniforms:{color:new t.Color(1,0,0,1),time:1,count:1,gradient:.1},source:t.Material.CircleWaveSource},translucent:function(e){return!0}}),t[i]=a,a}}]),e}(),h=p,m=function(e){Object(l["a"])(i,e);var t=Object(c["a"])(i);function i(e,r,o){var s;return Object(a["a"])(this,i),s=t.call(this,e,r,o),Object(u["a"])(Object(n["a"])(s),"count",void 0),s._CircleWaveMaterialProperty=new h(e,r),s}return Object(r["a"])(i,[{key:"change_duration",value:function(e){Object(o["a"])(Object(s["a"])(i.prototype),"change_duration",this).call(this,e);var t=this.viewer.entities.getById(this.id);t._ellipse._material.duration=e}},{key:"change_waveCount",value:function(e){var t=this.viewer.entities.getById(this.id);t._ellipse._material.count=e}},{key:"add",value:function(e,t,a,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,c=this.Cesium;Object(o["a"])(Object(s["a"])(i.prototype),"add",this).call(this,e,t,a,r,n);var u=this;this.count=l,this._CircleWaveMaterialProperty.create({cesiumName:"CircleWaveMaterialProperty",duration:r,gradient:0,color:new c.Color.fromCssColorString(t),count:l}),this.viewer.entities.add({id:u.id,position:c.Cartesian3.fromDegrees(e[0],e[1],e[2]),ellipse:{semiMinorAxis:new c.CallbackProperty((function(e){return u.maxRadius}),!1),semiMajorAxis:new c.CallbackProperty((function(e){return u.maxRadius}),!1),material:new c.CircleWaveMaterialProperty}})}}]),i}(d["a"]);t["a"]=m},a3d8:function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=i("c686"),o=i("b5db"),s=i("e4ae"),l=i("721f"),c=i("49ad"),u=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(t){var i=this.Cesium,a=(this.viewer,null!==t&&void 0!==t&&t.cesiumName?t.cesiumName:"");function r(){this._definitionChanged=new i.Event,this.color=t.color||i.Color.YELLOW,this.speed=t.speed||10}Object.defineProperties(r.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:i.createPropertyDescriptor("color"),speed:i.createPropertyDescriptor("speed")});var n="Scanline".concat(parseInt(1e3*Math.random()));return r.prototype.getType=function(e){return n},r.prototype.getValue=function(e,t){return i.defined(t)||(t={}),t.color=i.Property.getValueOrClonedDefault(this._color,e,i.Color.WHITE,t.color),t.speed=this.speed,t},r.prototype.equals=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{color:color,speed:speed},a=this===t||t instanceof e&&i.Property.equals(this.color,t.color)&&i.Property.equals(this.speed,t.speed);return a},i.Material.ScanlineSource="\n        uniform vec4 color;\n        uniform float speed;\n        float circle(vec2 uv, float r, float blur) {\n          float d = length(uv) * 1.0; /* 2.0 */\n          float c = smoothstep(r+blur, r, d);\n          return c;\n        }\n        czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n          czm_material material = czm_getDefaultMaterial(materialInput);\n          vec2 st = materialInput.st - 0.5;\n          material.diffuse = 2.8 * color.rgb;\n          material.emission = vec3(0);\n          float t = fract(czm_frameNumber * (11000.0 - speed) / 500000.0);\n          float s = 0.3;\n          float radius1 = smoothstep(.0, s, t) * 0.5;\n          float alpha1 = circle(st, radius1, 0.01) * circle(st, radius1, -0.01);\n          float alpha2 = circle(st, radius1, 0.01 - radius1) * circle(st, radius1, 0.01);\n          float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n          float alpha3 = circle(st, radius1, radius2 + 0.01 - radius1) * circle(st, radius1, -0.01);\n          material.alpha = smoothstep(1.0, s, t) * (alpha1 + alpha2*0.1 + alpha3*0.1);\n          material.alpha *= color.a ;\n          return material;\n        }\n        ",i.Material._materialCache.addMaterial(n,{fabric:{type:i.Material.ScanlineType,uniforms:{color:new i.Color(1,0,0,.5),time:0,speed:10},source:i.Material.ScanlineSource},translucent:function(e){return!0}}),i[a]=r,r}}]),e}(),d=u,p=function(e){Object(s["a"])(i,e);var t=Object(l["a"])(i);function i(e,r,n){var o;return Object(a["a"])(this,i),o=t.call(this,e,r,n),o._ScanlineMaterialProperty=new d(e,r),o}return Object(r["a"])(i,[{key:"change_duration",value:function(e){Object(n["a"])(Object(o["a"])(i.prototype),"change_duration",this).call(this,e);var t=this.viewer.entities.getById(this.id);t._ellipse._material.speed=e}},{key:"add",value:function(e,t,a,r){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=this.Cesium;Object(n["a"])(Object(o["a"])(i.prototype),"add",this).call(this,e,t,a,r,s);var c=this;this._ScanlineMaterialProperty.create({cesiumName:"ScanlineMaterialProperty",color:new l.Color.fromCssColorString(t),speed:r}),this.viewer.entities.add({id:c.id,position:l.Cartesian3.fromDegrees(e[0],e[1],e[2]),ellipse:{semiMinorAxis:new l.CallbackProperty((function(e){return c.maxRadius}),!1),semiMajorAxis:new l.CallbackProperty((function(e){return c.maxRadius}),!1),material:new l.ScanlineMaterialProperty,classificationType:l.ClassificationType.BOTH}})}}]),i}(c["a"]);t["a"]=p},a731:function(e,t,i){var a=i("a220");e.exports=function(e){return void 0!==e&&(a(e,"value")||a(e,"writable"))}},bc35:function(e,t,i){"use strict";var a=i("735b"),r=i("32da"),n=i("1c60");e.exports=function(e){var t=a(this),i=n(t),o=arguments.length,s=r(o>1?arguments[1]:void 0,i),l=o>2?arguments[2]:void 0,c=void 0===l?i:r(l,i);while(c>s)t[s++]=e;return t}},c686:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));i("eb3b"),i("68eb"),i("870b"),i("8877");var a=i("b5db");function r(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Object(a["a"])(e),null===e)break;return e}function n(){return n="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var a=r(e,t);if(a){var n=Object.getOwnPropertyDescriptor(a,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},n.apply(this,arguments)}},c78a:function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=(i("eb3b"),i("b1f6"),function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i,this.lastStageList=[]}return Object(r["a"])(e,[{key:"add",value:function(e,t,i,a){this.lastStageList.push(this.showCircleScan(e,t,i,a))}},{key:"clear",value:function(){var e=this;this.lastStageList.forEach((function(t){e.clearScanEffects(t)})),this.lastStageList=[]}},{key:"showCircleScan",value:function(e,t,i,a){var r=this.Cesium,n=new r.Cartographic(r.Math.toRadians(e[0]),r.Math.toRadians(e[1]),e[2]);t=new r.Color.fromCssColorString(t);var o=this._addCircleScanPostStage(n,i,t,a);return o}},{key:"_addCircleScanPostStage",value:function(e,t,i,a){var r=this.Cesium,n=r.Cartographic.toCartesian(e),o=new r.Cartesian4(n.x,n.y,n.z,1),s=new r.Cartographic(e.longitude,e.latitude,e.height+500),l=r.Cartographic.toCartesian(s),c=new r.Cartesian4(l.x,l.y,l.z,1),u=(new Date).getTime(),d=new r.Cartesian4,p=new r.Cartesian4,h=new r.Cartesian3,m=this,f=new r.PostProcessStage({fragmentShader:m._getScanSegmentShader(),uniforms:{u_scanCenterEC:function(){var e=r.Matrix4.multiplyByVector(m.viewer.camera._viewMatrix,o,d);return e},u_scanPlaneNormalEC:function(){var e=r.Matrix4.multiplyByVector(m.viewer.camera._viewMatrix,o,d),t=r.Matrix4.multiplyByVector(m.viewer.camera._viewMatrix,c,p);return h.x=t.x-e.x,h.y=t.y-e.y,h.z=t.z-e.z,r.Cartesian3.normalize(h,h),h},u_radius:function(){return t*(((new Date).getTime()-u)%a)/a},u_scanColor:i}});return this.viewer.scene.postProcessStages.add(f),f}},{key:"_getScanSegmentShader",value:function(){var e=18,t=" uniform sampler2D colorTexture;\n        uniform sampler2D depthTexture;\n        varying vec2 v_textureCoordinates;\n        uniform vec4 u_scanCenterEC;\n        uniform vec3 u_scanPlaneNormalEC;\n        uniform float u_radius;\n        uniform vec4 u_scanColor;\n        vec4 toEye(in vec2 uv, in float depth){\n          vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n          vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n          posInCamera =posInCamera / posInCamera.w;\n          return posInCamera;\n        }\n        vec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point){\n            vec3 v01 = point - planeOrigin;\n            float d = dot(planeNormal, v01) ;\n            return (point - planeNormal * d);\n        }\n        float getDepth(in vec4 depth){\n            float z_window = czm_unpackDepth(depth);\n            z_window = czm_reverseLogDepth(z_window);\n            float n_range = czm_depthRange.near;\n            float f_range = czm_depthRange.far;\n            return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n        }\n        void main(){\n            gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n            float depth = getDepth(texture2D(depthTexture, v_textureCoordinates));\n            vec4 viewPos = toEye(v_textureCoordinates, depth);\n            vec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\n            float dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\n            if(dis < u_radius){\n              float f = 1.0 - abs(u_radius - dis) / u_radius;\n              f = pow(f, float("+e+"));\n              gl_FragColor = mix(gl_FragColor,u_scanColor,f);\n            }\n            gl_FragColor.a = gl_FragColor.a / 2.0;\n        }\n      ";return t}},{key:"clearScanEffects",value:function(e){this.viewer.scene.postProcessStages.remove(e)}}]),e}());t["a"]=n},d56e:function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=i("4eba"),o=(i("2237"),i("78be"),i("2afa"),function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(t){var i=this.Cesium,a=(this.viewer,null!==t&&void 0!==t&&t.cesiumName?t.cesiumName:"");function r(){this._definitionChanged=new i.Event,this._color=void 0,this._colorSubscription=void 0,this.color=t.color}Object.defineProperties(r.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:i.createPropertyDescriptor("color")});var n="WallGradients".concat(parseInt(1e3*Math.random()));return r.prototype.getType=function(e){return n},r.prototype.getValue=function(e,t){return i.defined(t)||(t={}),t.color=i.Property.getValueOrClonedDefault(this._color,e,i.Color.WHITE,t.color),t.image=i.Material.WallGradientsImage,t},r.prototype.equals=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{_color:_color},a=this===t||t instanceof e&&i.Property.equals(this._color,t._color);return a},i.Material.WallGradientsImage="/cesium-template/cesium/effects/Materials/wallgradients.png",i.Material.WallGradientsSource="\n      czm_material czm_getMaterial(czm_materialInput materialInput)\n      {\n          czm_material material = czm_getDefaultMaterial(materialInput);\n          vec2 st = materialInput.st;\n          vec4 colorImage = texture2D(image, vec2(fract(st.t - time), st.t));\n          material.alpha = colorImage.a * color.a;\n          material.diffuse =  2.5 * color.rgb  ;\n          return material;\n      }\n      ",i.Material._materialCache.addMaterial(n,{fabric:{type:i.Material.WallGradientsType,uniforms:{color:new i.Color(0,1,0,.5),image:i.Material.WallGradientsImage,time:0},source:i.Material.WallGradientsSource},translucent:function(e){return!0}}),i[a]=r,r}}]),e}()),s=o,l=function(){function e(t,i,r){Object(a["a"])(this,e),Object(n["a"])(this,"viewer",void 0),Object(n["a"])(this,"id",void 0),Object(n["a"])(this,"duration",void 0),Object(n["a"])(this,"maxRadius",void 0),Object(n["a"])(this,"pointDraged",void 0),Object(n["a"])(this,"leftDownFlag",void 0),Object(n["a"])(this,"update_position",void 0),Object(n["a"])(this,"wallHeight",void 0),Object(n["a"])(this,"position",void 0),Object(n["a"])(this,"edgeCount",void 0),this.Cesium=t,this.viewer=i,this.id=r,this.duration=1e3,this.maxRadius=1e3,this.pointDraged=null,this.leftDownFlag=!1,this.position=null,this.edgeCount=0,this._WallGradientsMaterialProperty=new s(t,i)}return Object(r["a"])(e,[{key:"del",value:function(){this.viewer.entities.removeById(this.id)}},{key:"change_position",value:function(e){var t=this.Cesium,i=t.Cartographic.fromDegrees(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));i.height<0&&(i.height=0),this.position=i}},{key:"change_color",value:function(e){var t=this.Cesium,i=this.viewer.entities.getById(this.id);i._wall._material.color=new t.Color.fromCssColorString(e)}},{key:"change_height",value:function(e){this.wallHeight=e}},{key:"change_duration",value:function(e){this.duration=e}},{key:"add",value:function(e,t,i,a,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=this.Cesium;e=s.Cartographic.fromDegrees(e[0],e[1],e[2]),e.height<0&&(e.height=0),this.position=e,this.wallHeight=r,this.duration=a,this.maxRadius=i,this.edgeCount=n;var l=i,c=this.getrPositions({},i,e,n,l),u=this;o&&this.mouseEvent(),this._WallGradientsMaterialProperty.create({cesiumName:"WallGradientsMaterialProperty",color:new s.Color.fromCssColorString(t)}),this.viewer.entities.add({id:u.id,wall:{positions:new s.CallbackProperty((function(e){var t=u.getPositions(l,u.maxRadius,u.getrPositions(c,u.maxRadius,u.position,u.edgeCount,l),u.getcenterDegrees(u.position),u.duration,u.edgeCount);return l=t.currentRadius,c=t.rPositions,c[l]}),!1),minimumHeights:new s.CallbackProperty((function(e){var t=u.getminimumHeights(c[u.maxRadius]);return t}),!1),maximumHeights:new s.CallbackProperty((function(e){var t=u.getmaximumHeights(c[u.maxRadius]);return t}),!1),material:new s.WallGradientsMaterialProperty}})}},{key:"mouseEvent",value:function(){var e=this.Cesium,t=this;function i(e){t.pointDraged=t.viewer.scene.pick(e.position),t.pointDraged&&t.pointDraged.id&&t.pointDraged.id.id===t.id&&(t.leftDownFlag=!0,t.viewer.scene.screenSpaceCameraController.enableRotate=!1)}function a(e){t.leftDownFlag=!1,t.pointDraged=null,t.viewer.scene.screenSpaceCameraController.enableRotate=!0}function r(i){if(!0===t.leftDownFlag&&null!==t.pointDraged&&void 0!==t.pointDraged){var a=t.viewer.camera.getPickRay(i.endPosition),r=t.viewer.scene.globe.pick(a,t.viewer.scene),n=t.viewer.scene.globe.ellipsoid,o=n.cartesianToCartographic(r),s=e.Math.toDegrees(o.latitude),l=e.Math.toDegrees(o.longitude),c=o.height;c=c<0?0:c,t.update_position&&t.update_position([l.toFixed(8),s.toFixed(8),c]),t.change_position([l.toFixed(8),s.toFixed(8),c])}}this.viewer.screenSpaceEventHandler.setInputAction(i,e.ScreenSpaceEventType.LEFT_DOWN),this.viewer.screenSpaceEventHandler.setInputAction(a,e.ScreenSpaceEventType.LEFT_UP),this.viewer.screenSpaceEventHandler.setInputAction(r,e.ScreenSpaceEventType.MOUSE_MOVE)}},{key:"getrPositions",value:function(e,t,i,a,r){var n=this.getcenterDegrees(this.position);return i=this.generateCirclePoints([n[0],n[1]],r,a),i=this.pointsToPositions(i,n[2]),e[t]=i,e}},{key:"getcenterDegrees",value:function(e){var t=this.Cesium,i=[t.Math.toDegrees(e.longitude),t.Math.toDegrees(e.latitude),e.height];return i}},{key:"getminimumHeights",value:function(e){return new Array(e.length).fill(this.position.height)}},{key:"getmaximumHeights",value:function(e){return new Array(e.length).fill(this.position.height+this.wallHeight)}},{key:"getPositions",value:function(e,t,i,a,r,n){if(e+=1e3/r*20,e>t&&(e=1))return{rPositions:i,currentRadius:e};var o=this.generateCirclePoints([a[0],a[1]],e,n);return o=this.pointsToPositions(o,a[2]),i[e]=o,{rPositions:i,currentRadius:e}}},{key:"pointsToPositions",value:function(e,t){var i=this.Cesium,a=[];return e.map((function(e){a.push(i.Cartesian3.fromDegrees(e[0],e[1],t))})),a}},{key:"generateCirclePoints",value:function(e,t,i){var a=[];if(i)for(var r=360/i,n=0;n<=360;n+=r)a.push(this.getCirclePoint(e[0],e[1],n,t));else for(var o=0;o<=360;o+=2)a.push(this.getCirclePoint(e[0],e[1],o,t));return a}},{key:"getCirclePoint",value:function(e,t,i,a){var r=a*Math.sin(i*Math.PI/180);return a*=Math.cos(i*Math.PI/180),[180*(r/((i=6356725+21412*(90-t)/90)*Math.cos(t*Math.PI/180))+e*Math.PI/180)/Math.PI,180*(a/i+t*Math.PI/180)/Math.PI]}}]),e}();t["a"]=l},d97d:function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=(i("eb3b"),i("b1f6"),i("34b1"),i("3977")),o=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(t){var i=this.Cesium,a=(this.viewer,null!==t&&void 0!==t&&t.cesiumName?t.cesiumName:"");function r(){this._definitionChanged=new i.Event,this.colorSubscription=void 0,this.speed=t.speed||6*Math.random(),this.color=t.color||i.Color.RED,this.percent=t.percent||.1,this.gradient=t.gradient||.01}Object.defineProperties(r.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:i.createPropertyDescriptor("color"),speed:i.createPropertyDescriptor("speed"),gradient:i.createPropertyDescriptor("gradient"),percent:i.createPropertyDescriptor("percent")});var n="PolylineTrail".concat(parseInt(1e3*Math.random()));return r.prototype.getType=function(e){return n},r.prototype.getValue=function(e,t){return i.defined(t)||(t={}),t.color=i.Property.getValueOrClonedDefault(this.color,e,i.Color.WHITE,t.color),t.speed=this.speed,t.gradient=this.gradient,t.percent=this.percent,t},r.prototype.equals=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{color:color,speed:speed};return this===t||t instanceof e&&this.speed===t.speed&&i.Property.equals(this.color,t.color)},i.Material.PolylineTrailSource="\n          uniform vec4 color;\n          uniform float speed;\n          uniform float percent;\n          uniform float gradient;\n          \n          czm_material czm_getMaterial(czm_materialInput materialInput){\n            czm_material material = czm_getDefaultMaterial(materialInput);\n            vec2 st = materialInput.st;\n            float t = fract(czm_frameNumber * speed / 1000.0);\n            t *= (1.0 + percent);\n            float alpha = smoothstep(t- percent, t, st.s) * step(-t, -st.s);\n            alpha += gradient;\n            material.diffuse = color.rgb;\n            material.alpha = alpha;\n            return material;\n          }\n          ",i.Material._materialCache.addMaterial(n,{fabric:{type:i.Material.PolylineTrailType,uniforms:{color:new i.Color(1,0,0,.5),transparent:!0,speed:0,gradient:.01,percent:.1},source:i.Material.PolylineTrailSource},translucent:function(e){return!0}}),i[a]=r,r}}]),e}(),s=o,l=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(t){var i=this.Cesium,a=(this.viewer,null!==t&&void 0!==t&&t.cesiumName?t.cesiumName:"");function r(){this._definitionChanged=new i.Event,this.duration=t.duration,this.image=t.image,this._time=performance.now()}Object.defineProperties(r.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:i.createPropertyDescriptor("color"),duration:i.createPropertyDescriptor("duration")});var n="Spriteline1".concat(parseInt(1e3*Math.random()));return r.prototype.getType=function(e){return n},r.prototype.getValue=function(e,t){return i.defined(t)||(t={}),t.image=this.image,t.time=(performance.now()-this._time)%this.duration/this.duration,t},r.prototype.equals=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{duration:duration};return this===t||t instanceof e&&this.duration===t.duration},i.Material.Spriteline1Source="\n                    czm_material czm_getMaterial(czm_materialInput materialInput)\n                    {\n                    czm_material material = czm_getDefaultMaterial(materialInput);\n                    vec2 st = materialInput.st;\n                    vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n                    material.alpha = colorImage.a;\n                    material.diffuse = colorImage.rgb * 1.5 ;\n                    return material;\n                    }\n                    ",i.Material._materialCache.addMaterial(n,{fabric:{type:i.Material.Spriteline1Type,uniforms:{color:new i.Color(1,0,0,.5),image:"",transparent:!0,time:20},source:i.Material.Spriteline1Source},translucent:function(e){return!0}}),i[a]=r,r}}]),e}(),c=l,u=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i,this.FlyLinesEntities=[],this._PolylineTrailMaterialProperty=new s(t,i),this._Spriteline1MaterialProperty=new c(t,i)}return Object(r["a"])(e,[{key:"flyLines",value:function(e,t,i,a,r,o,s,l){var c=this.Cesium,u=this;this._PolylineTrailMaterialProperty.create({cesiumName:"PolylineTrailMaterialProperty",speed:r*Math.random(),color:new c.Color.fromCssColorString(t),percent:o,gradient:s});var d,p,h,m=n["randomPoint"](l,{bbox:e}),f=m.features;f.forEach((function(e){d=e.geometry.coordinates,p=c.Cartesian3.fromDegrees(d[0],d[1],0),h=c.Cartesian3.fromDegrees(d[0],d[1],a*Math.random()),u.FlyLinesEntities.push(u.viewer.entities.add({polyline:{positions:[p,h],width:i,material:new c.PolylineTrailMaterialProperty}}))}))}},{key:"RoadPic",value:function(e,t,i,a){var r=this,n=this.Cesium;this._Spriteline1MaterialProperty.create({cesiumName:"Spriteline1MaterialProperty",duration:a,image:t});var o=n.GeoJsonDataSource.load(e);o.then((function(e){r.viewer.dataSources.add(e),r.RoadPicEntities=e.entities.values;for(var t=0;t<r.RoadPicEntities.length;t++){var a=r.RoadPicEntities[t];a.polyline.width=i,a.polyline.material=new n.Spriteline1MaterialProperty}}))}}]),e}();t["a"]=u},ed25:function(e,t,i){"use strict";var a=i("4bb1"),r=i("e143"),n=i("c686"),o=i("b5db"),s=i("e4ae"),l=i("721f"),c=i("49ad"),u=function(){function e(t,i){Object(a["a"])(this,e),this.Cesium=t,this.viewer=i}return Object(r["a"])(e,[{key:"create",value:function(t){var i=this.Cesium,a=(this.viewer,null!==t&&void 0!==t&&t.cesiumName?t.cesiumName:"");function r(){this._definitionChanged=new i.Event,this._color=void 0,this._colorSubscription=void 0,this.color=t.color,this.duration=t.duration,this._time=(new Date).getTime()}Object.defineProperties(r.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:i.createPropertyDescriptor("color")});var n="EllipsoidFadeMaterialProperty".concat(parseInt(1e3*Math.random()));return r.prototype.getType=function(e){return n},r.prototype.getValue=function(e,t){return i.defined(t)||(t={}),t.color=i.Property.getValueOrClonedDefault(this._color,e,i.Color.WHITE,t.color),t.time=((new Date).getTime()-this._time)%this.duration/this.duration,t},r.prototype.equals=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{_color:_color},a=this===t||t instanceof e&&i.Property.equals(this._color,t._color);return a},i.Material.EllipsoidFadeSource="\n          czm_material czm_getMaterial(czm_materialInput materialInput) {\n            czm_material material = czm_getDefaultMaterial(materialInput);\n            \n            material.diffuse = 1.5 * color.rgb;\n            vec2 st = materialInput.st;\n            float dis = distance(st, vec2(0.5, 0.5));\n            float bl = .0;\n            float offset = 0.42;\n            if( dis > 0.5) {\n              material.alpha = 0.0;\n              discard;\n            }\n            if( dis > offset) {\n              bl = color.a * 1.0 / (0.5 - offset) * (dis - offset);\n              material.alpha =  pow(bl, 3.0);\n            } else {\n              material.alpha = 0.0;\n              discard;\n            }\n            return material;\n          }\n          ",i.Material._materialCache.addMaterial(n,{fabric:{type:i.Material.EllipsoidFadeType,uniforms:{color:new i.Color(1,0,0,.5),time:0},source:i.Material.EllipsoidFadeSource},translucent:function(e){return!0}}),i[a]=r,r}}]),e}(),d=u,p=function(e){Object(s["a"])(i,e);var t=Object(l["a"])(i);function i(e,r,n){var o;return Object(a["a"])(this,i),o=t.call(this,e,r,n),o._EllipsoidFadeMaterialProperty=new d(e,r),o}return Object(r["a"])(i,[{key:"add",value:function(e,t,a,r){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=this.Cesium;Object(n["a"])(Object(o["a"])(i.prototype),"add",this).call(this,e,t,a,r,s);var c=this,u=1;this._EllipsoidFadeMaterialProperty.create({cesiumName:"EllipsoidFadeMaterialProperty",duration:c.duration,color:new l.Color.fromCssColorString(t)});var d=this.viewer.entities.add({id:c.id,position:l.Cartesian3.fromDegrees(e[0],e[1],e[2]),ellipse:{semiMajorAxis:new l.CallbackProperty((function(e){return u+=1e3/c.duration*50,u>c.maxRadius&&(u=1),u}),!1),semiMinorAxis:new l.CallbackProperty((function(e){return u}),!1),material:new l.EllipsoidFadeMaterialProperty}});return d.id}}]),i}(c["a"]);t["a"]=p}}]);